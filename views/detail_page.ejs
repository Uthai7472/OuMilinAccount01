<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      .top-bar {
        min-width: 50rem;
      }
      .month-topic {
        width: 100%;
        height: auto;
        padding: 10px;
       
        display: flex;
        justify-content: center;
        margin: 1rem;
        min-width: 50rem;
        border-radius: 10px;
        background-color: rgb(246, 193, 193);
        color: rgb(250, 250, 250);
      }
      .note-container {
        width: 100%;
        height: auto;
        border: 2px solid rgb(201, 233, 238); /* Set the border color and width */
        box-shadow: 0 0 10px rgb(201, 233, 238); /* Add a glowing effect using box-shadow */
        margin: 1rem;
        padding: 1rem;
        min-width: 50rem;
        padding: 10px;
        border-radius: 10px;
        background-color: rgb(201, 233, 238);
      }
      .textarea {
        width: 90%;
        height: 65%;
        min-width: 90%;
        /* border: 1px solid purple; */
      }
      textarea {
        width: 100%;
        height: 100%;
        border-radius: 5px;
        border: 3px solid rgb(149, 125, 173);
        background-color: rgb(149, 125, 173);
        padding: 5px;
        color: rgb(254, 200, 216);
      }

      .table-header {
        width: 100%;
        height: auto;
        background-color: rgb(246, 193, 193);
        border-radius: 10px 10px 0 0;
        margin: 1rem 1rem 0 1rem;
        padding: 10px;
        display: flex;
        justify-content: space-between;
        min-width: 50rem;
      }
      .col-1 {
        width: 10rem;
        height: auto;
        
        /* border: 1px solid red; */
        display: flex;
        justify-content: center;
      }
      .col-2 {
        width: 10rem;
        height: auto;
        /* border: 1px solid red; */
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .col-3 {
        width: 15rem;
        height: auto;
        /* border: 1px solid red; */
        display: flex;
        justify-content: center;
      }
      .col-4 {
        width: 5rem;
        height: auto;
        /* border: 1px solid red; */
        display: flex;
        justify-content: center;
      }
      .col-5 {
        width: 10rem;
        height: auto;
        /* border: 1px solid red; */
        display: flex;
        justify-content: center;
      }

      .table-input {
        width: 100%;
        height: 4rem;
        background-color: rgb(255, 253, 226);
        
        margin: 0 1rem 0 1rem;
        padding: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        min-width: 50rem;
      }
      .table-input .col-1 {
        width: 10rem;
        /* margin-left: 5px; */
        /* border: 1px solid red; */
        margin: 0;
      }
      .table-input .col-2 {
        width: 10rem;
        height: 1.8rem;
        /* border: 1px solid red; */
        padding: 0 10px 0 10px;
        margin: 0;
        transform: translateX(-5px);
      }
      .table-input .col-3 {
        width: 15rem;
        height: 1.8rem;
        /* border: 1px solid red; */
        padding-left: 10px;
        padding-right: 10px;
        transform: translateX(-6px);
      }
      .table-input .col-4 {
        width: 5rem;
        /* margin-left: 5px; */
        height: 1.8rem;
        /* border: 1px solid red; */
        padding-left: 10px;
        padding-right: 10px;
        transform: translateX(-20px);
      }
      .table-input .col-5 {
        width: 10rem;
        /* margin-left: 5px; */
        /* height: 1.8rem; */
        /* border: 1px solid red; */
        /* padding-left: 10px; */
        transform: translateX(-2rem);
        padding-left: 10px;
        padding-right: 10px;
      }
      .table-input .btn.btn-primary {
        width: 100%;
        height: 100%;
        /* height: 3rem; */
        font-size: 14px;
        background-color: rgb(233, 129, 150);
        border: none;
        border-radius: 20px;
        /* margin-bottom: 10px; */
        /* margin-bottom: 10px; */
      }
      input[type="date"], input[type="text"], input[type="number"] {
        width: 100%;
        padding-left: 10px;
        padding-right: 10px;
        border-radius: 5px;
        color: rgb(127, 100, 184);
      }
      select {
        width: 100%;
        height: 100%;
        color: rgb(127, 100, 184);
        background-color: rgb(254, 200, 216);
        border-radius: 5px;
        padding-left: 10px;
        padding-right: 10px;
      }
      input[type="text"] {
        width: 100%;
        color: rgb(127, 100, 184);
      }

      .table-sum {
        width: 100%;
        height: auto;
        border-radius: 0 0 10px 10px;
        background-color: rgb(194, 243, 159);
        color: rgb(233, 129, 150);
        margin: 0 1rem 0 1rem;
        padding: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        min-width: 50rem;
      }

      .table-history {
        width: 100%;
        height: auto;
        margin: 0 1rem 0 1rem;
        border-bottom: 3px dotted rgb(233, 129, 150);
        padding: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        min-width: 50rem;
        background-color: (253, 244, 171);
      }
      .btn.btn-danger {
        background-color: rgb(219, 181, 247);
        border-radius: 20px;
        border: none;
      }
      
      .btn.btn-success {
        border: none;
        border-radius: 20px;
        background-color: rgb(240, 136, 136);
        color: white;
      }
      .btn.btn-warning {
        border: none;
        border-radius: 20px;
        background-color: rgb(57, 57, 57);
        color: white;
      }

      @media screen and (max-width: 500px) {
        h5 {
          font-size: 16px;
        }
        h4 {
          font-size: 18px;
        }

        .month-topic {
          justify-content: flex-start;

        }

        textarea {
          width: 100%;
          /* height: 65%; */
          /* border: 1px solid red; */
          /* margin: auto 0; */
          /* min-width: 600px; */
        }

        .note-container, .btn.btn-primary {
          font-size: 12px;
        }

        .table-input .col-4 {
          transform: translateX(-6px);
        }
        .table-input .col-5 {
          transform: translateX(0.4rem);
          
        }
        
      }

      @media screen and (max-width: 825px) {
        .table-input .col-4 {
          transform: translateX(-6px);
        }
        .table-input .col-5 {
          transform: translateX(0.4rem);
          
        }
      }
    </style>
</head>
<body>
    
    <%- include('subview/header') %>

    <div class="month-topic">
      <h2>เดือน <%= month_name %></h2>
    </div>

    <form action="/data_page/detail/save_note" method="POST">
      <div class="note-container">
        <div class="note-topic">
          <h4>Note :</h4>
        </div>
        <div>
          <input type="text" name="month" id="month" value="<%= month_name %>" hidden>
        </div>
        <div class="textarea">
          <textarea name="note" id="note" readonly><%= get_note[0].note %></textarea>
        </div>
        <div class="remark-action">
          <button type="submit" class="btn btn-success">บันทึก</button>
          <button type="button" class="btn btn-warning edit">เเก้ไข</button>
        </div>
      </div>
    </form>

    <div class="table-header">
      <div class="col-1">
        <h5>วันที่</h5>
      </div>
      <div class="col-2">
        <h5>หมวดหมู่</h5>
      </div>
      <div class="col-3">
        <h5>รายการ</h5>
      </div>
      <div class="col-4">
        <h5>ราคา</h5>
      </div>
      <div class="col-5">
        <h5>Action</h5>
      </div>
    </div>

    <form action="/data_page/detail/add" method="POST">
      <div class="table-input">
        <input type="text" name="month" id="month" value="<%= month_name %>" hidden>
        <textarea name="note" id="note" hidden><%= get_note[0].note %></textarea>
        <div class="col-1">
          <input type="date" name="date" id="date" required>
        </div>
        <div class="col-2">
          <select name="category" id="category">
            <option value="สำคัญ">สำคัญ</option>
            <option value="ของใช้">ของใช้</option>
            <option value="ข้างนอก">ข้างนอก</option>
            <option value="ดีต่อใจ">ดีต่อใจ</option>
            <option value="สุขภาพ">สุขภาพ</option>
            <option value="ทำกินเอง">ทำกินเอง</option>
            <option value="ประกัน">ประกัน</option>
            <option value="เติม/ถอน">เติม/ถอน</option>
            <option value="มิลิน">มิลิน</option>
            <option value="อู๋">อู๋</option>
            <option value="ช้อปปิ้ง">ช้อปปิ้ง</option>
            <option value="อื่นๆ">อื่นๆ</option>
            <option value="กินเล่น">กินเล่น</option>
          </select>
        </div>
        <div class="col-3">
          <input type="text" name="detail" id="detail" required>
        </div>
        <div class="col-4">
          <input type="number" name="price" id="price" required>
        </div>
        <div class="col-5">
          <button type="submit" class="btn btn-primary"><i class="fas fa-heart" style="color: rgb(49, 181, 189);"></i> เพิ่มรายจ่าย</button>
        </div>
      </div>
    </form>

    <div class="table-sum">
      <div class="col-1">
        <h5>รวมทั้งหมด</h5>
      </div>
      <div class="col-2">
        
      </div>
      <div class="col-3">
        
      </div>
      <div class="col-4">
        <h5><%= get_sum[0].sumPrice ? get_sum[0].sumPrice : '0' %></h5>
      </div>
      <div class="col-5">
        บาท
      </div>
    </div>

    
      <% get_history.forEach((row) => { %> 
        <% if (row.date) { %>
        <div class="table-history">
          <div class="col-1">
            <h5><%= row.date ? row.date.toLocaleDateString('en-GB') : '' %></h5>
          </div>
          <div class="col-2">
            <h5><%= row.category %></h5>
          </div>
          <div class="col-3">
            <h5><%= row.detail %></h5>
          </div>
          <div class="col-4">
            <h5><%= row.price %></h5>
          </div>
          <div class="col-5">
            <!-- <a href="" class="btn btn-warning">เเก้ไข</a> -->
            <a href="/data_page/detail/delete?id=<%= row.id %>&month=<%= row.month %>" class="btn btn-danger">ลบ</a>
          </div>
        </div>
        <% } %>
      <% }) %>
    

    <script>
      const editButton = document.querySelector('.edit');
      const noteTextarea = document.getElementById('note');
    
      editButton.addEventListener('click', function() {
        noteTextarea.readOnly = !noteTextarea.readOnly;
        noteTextarea.focus();
      });
    </script>

</body>
</html>